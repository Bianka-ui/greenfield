<?xml version="1.0" encoding="UTF-8"?>
<protocol name="session" version="1">
  <copyright>
    Session Protocol for use with an HTML5 Wayland compositor.
    Copyright (C) 2017 Erik De Rijcke

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program. If not, see &gt;http://www.gnu.org/licenses/&lt;.
  </copyright>

  <interface name="GrClientSession" version="1">
    <description>
      A client session.
    </description>

    <request name="destroy" since="1">
      <description>
        Request the browser compositor to destroy this client object and all related resources.
      </description>
    </request>
  </interface>

  <interface name="GrSession" version="1">
    <description>
      A global singleton. Functions as a general communication mechanism between a native shim compositor and a
      browser implemented compositor.
    </description>

    <request name="client" since="1">
      <description>
        Request a new client session. The remote browser compositor is expected to
        initiate a new websocket connection as a response. This enables the local server to use the newly
        established websocket connection for client to browser compositor communication.
      </description>
      <arg name="id" type="new_id" interface="GrClientSession" summary="the new client session"/>
      <arg name="connection" type="uint"
           summary="unique compositor identifier for the newly created client session"/>
    </request>

    <event name="flush" since="1">
      <description>
        Notify the native shim compositor to flush his connection with native wayland clients.
      </description>
    </event>
  </interface>
</protocol>